!function($){var e={whens:[],sets:[],indexWhens:function(){return new Promise(((t,s)=>{$("when").each(((t,s)=>{var a={event:$(s).attr("event"),media:$(s).attr("media"),statements:this.indexStatements($(s))};e.whens.push(a)})),t()}))},indexStatements:function(e){var t=[];return e.children().each(((e,s)=>{var a={tag:s.tagName.toLowerCase(),attributes:Array.from(s.attributes).map((e=>({name:e.name,value:e.value}))),children:this.indexStatements($(s))};"select-all"!==a.tag&&"set"!==a.tag||(a.targets=this.processTargets(a,$(s))),0===a.children.length?delete a.children:a.children=a.children.map((e=>(e.text=$(s).find(e.tag).text(),e))),t.push(a)})),t},processWhens:function(){return new Promise(((e,t)=>{this.whens.forEach(((e,t)=>{e.media?enquire.register(e.media,{match:()=>{console.log(`When element ${t+1} has been processed.`),this.processStatements(e.statements)}}):(console.log(`When element ${t+1} has been processed.`),this.processStatements(e.statements))})),e()}))},processStatements:function(e){e.forEach((e=>{if("select-all"===e.tag){var t=e.targets;e.children.forEach((e=>{"css"===e.tag?this.processCssStatement(e,t):"attr"===e.tag?this.processAttrStatement(e,t):"add-class"===e.tag&&this.processAddClassStatement(e,t)}))}}))},processAddClassStatement:function(e,t){var s=e.text;t.forEach((e=>{$(e).addClass(s)}))},processAttrStatement:function(e,t){var s={};e.children.forEach((e=>{s[e.tag]=e.text})),t.forEach((e=>{for(var t in s)$(e).attr(t,s[t])}))},processCssStatement:function(e,t){var s={};e.children.forEach((e=>{s[e.tag]=e.text})),t.forEach((e=>{$(e).css(s)}))},processTargets:function(e,t){var s=[],a=e.attributes.find((e=>"targets"===e.name));a&&$(a.value).each(((e,t)=>{s.push(t)}));var n=e.children.find((e=>"targets"===e.tag));if(!n||n.children&&n.children.length||s.push($(t.find("targets").text())),n&&n.attributes){var r=n.attributes.find((e=>"for-each"===e.name));r&&$(r.value).each(((e,t)=>{var a=$(t);n.children.forEach((e=>{a=a[e.tag](e.text)})),s.push(a)}))}if("set"===e.tag){var i=e.children.find((e=>"select-all"===e.tag));i&&(s=this.processTargets(i,$(i.children)));var h=e.attributes.find((e=>"name"===e.name)).value;this.sets[h]=s}return s},refresh:function(){Promise.all([this.indexWhens(),this.processWhens()]).then((()=>{console.log("indexWhens and processWhens have finished processing")}))}};window.hijinx=e,$(window).on("load",(function(){e.refresh(),console.log("hijinx:",e)}))}(jQuery);